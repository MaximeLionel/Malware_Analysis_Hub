# Static Analysis Clues
* source of malware: lab06-04 of book 'practical malware analysis'.
* md5,6ABDE2F83015F066385D27CFF6143C44
* sha1,536E6F91D4515E30AF7AFD37F22C213FEE152126
* sha256,FE30F280B1D0A5E9CEF3324C2E8677F55A6202599D489170ECE125F3CD843A03
* No Packer - signature,Microsoft Visual C++ v6.0.
* window, network, keyboard-and-mouse.
* APIs:
  * InternetGetConnectedState,0x66,0x65B8,network,implicit,-,x,wininet.dll
  * TerminateProcess,0x29E,0x660E,execution,implicit,-,x,kernel32.dll
  * GetEnvironmentStrings,0x106,0x66B2,execution,implicit,-,x,kernel32.dll
* Strings:
  * ascii,22,0x00007047,-,-,-,Error 1.1: No Internet
  * ascii,28,0x00007065,-,-,-,Success: Internet Connection

# Use IDA to analyze
1. check for internet connection.
2. enter a for loop and totally 1440 loops:
   ```
    loc_40125A:
    cmp     [ebp+i], 1440
    jge     short end_of_loop
   ```
3. start to read from url: http://www.practicalmalwareanalysis.com/cc.htm.
   ```
    mov     ecx, [ebp+i]
    push    ecx
    call    open_read_interneturl
   ```
   * check the first specific characters of the read: '<--'.
   * then read the next character in **al** which call it 'command'.
   ```
    mov     al, [ebp+Buffer+4]
    jmp     short loc_401140
   ```
4. switch 'command', do different actions:
   * case 'a', create a directory - C:\\Temp.
   * case 'b', copy file to C:\\Temp\\cc.exe.
   * case 'c', delete file in C:\\Temp\\cc.exe.
   * case 'd', modify registry: Software\Microsoft\Windows\CurrentVersion\Run. Add C:\\Temp\\cc.exe and Malware as the key and value.
   * case 'e', sleep for 100s.
5. sleep for 60s and then continue to next loop. After 1440 loops, the program exits.